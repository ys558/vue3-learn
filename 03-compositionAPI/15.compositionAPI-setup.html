<div id="app">
  {{state.counter}}
  <comp dong="dong" tua="tua">some content</comp>
</div>

<script src="https://unpkg.com/vue@3"></script>
<script>
  const { createApp, reactive, h, getCurrentInstance } = Vue
  const vm = createApp({
    // 2. setupå‡½æ•°çš„å‚æ•°å¯ä»¥ä¸º
    setup(props, ctx) {
      // 3. èŽ·å–ç»„ä»¶å®žä¾‹
      const instance = getCurrentInstance()
      console.log("ðŸš€ ~ file: 15.compositionAPI-setup.html ~ line 14 ~ setup ~ instance", instance)

      const state = reactive({ counter: 0})
      
      setInterval(()=> state.counter ++ , 500)
      return { state }

      // 1. å¯ç›´æŽ¥è¿”å›žå‡½æ•°æˆ–è€…jsx
      // return () => h('div', state.counter)
    },
    components: {
      Comp: {
        template: '<div><slot>comp</slot></div>',
        props: {
          dong: {
            type: String,
            default: ''
          }
        },
        setup(props, {attrs, slots, emit}) {
          // å¯ä»¥å‘çŽ° propsä¸æ˜¯æ™®é€šå‚æ•°, æ˜¯ä¸€ä¸ªä»£ç† Proxy, 
          // æ‰€ä»¥ä½¿ç”¨propsé‡Œé¢çš„ä¸œè¥¿ä¸èƒ½ç›´æŽ¥åœ¨æ‹¬å·é‡Œç›´æŽ¥è§£æž„ä½ è¦çš„å‚æ•°, åº”ä¸º: props.dong
          // console.log(props, ctx) // ProxyÂ {dong: 'dong'} {expose: Æ’}

          /* ctx æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°, æ‰€ä»¥å¯ä»¥åœ¨æ‹¬å·é‡Œç›´æŽ¥è§£æž„.
            attrs: Proxy
            emit: (event, ...args) => instance.emit(event, ...args)
            expose: exposed => {â€¦}
            slots: Proxy
          */
          console.log(attrs, slots, emit)
        } 
      }
    }
  })
  .mount('#app')

</script>